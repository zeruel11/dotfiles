{
    "version": "1.4.1",
    "description": "Use the Windows SSH agent from inside WSL",
    "homepage": "https://github.com/rupor-github/wsl-ssh-agent",
    "license": "GPL-3.0-only",
    "url": "https://github.com/rupor-github/wsl-ssh-agent/releases/download/v1.4.1/wsl-ssh-agent.7z",
    "hash": "44025be1f70f6494bc24dd9c27821e2a7b152788a6447dd87d41be32dfef1e2c",
    "bin": [
        [
            "wsl-ssh-agent-gui.exe",
            "wsl-ssh-agent-gui"
        ]
    ],
    "checkver": "github",
    "autoupdate": {
        "url": "https://github.com/rupor-github/wsl-ssh-agent/releases/download/v$version/wsl-ssh-agent.7z"
    },
    "post_install": [
        "Write-Host -ForegroundColor Blue -NoNewline 'Do you want to run wsl-ssh-agent as scheduled task? (needs Administrator privileges)'",
        "$UserAnswer = Read-Host",
        "if ($UserAnswer -match '^[Yy](es)?$') {",
        "$currentPrincipal = New-Object Security.Principal.WindowsPrincipal([Security.Principal.WindowsIdentity]::GetCurrent())",
        "if ($currentPrincipal.IsInRole([Security.Principal.WindowsBuiltInRole]::Administrator)) {",
        "$User = \"$env:USERDOMAIN\\$env:USERNAME\"",
        "$Trigger = New-ScheduledTaskTrigger -AtLogOn -RandomDelay 00:00:30",
        "$Action = New-ScheduledTaskAction -Execute \"$env:SCOOP\\apps\\wsl-ssh-agent\\current\\wsl-ssh-agent-gui.exe\" -Argument \"-setenv -envname=WSL_AUTH_SOCK -lemonade=2489;127.0.0.1/24\"",
        "Register-ScheduledTask -TaskName \"WSL ssh-agent\" -Trigger $Trigger -User $User -Action $Action",
        "} else {",
        "Write-Warning \"You do not have Administrator privileges. Please run \"\"scoop reset $app\"\" from elevated console...\"",
        "}",
        "}"
    ],
    "notes": [
        "EXAMPLE USAGE",
        "On Windows:",
        "wsl-ssh-agent-gui.exe -setenv -envname=WSL_AUTH_SOCK -lemonade=2489;127.0.0.1/24",
        "Add to WSL bash .bashrc:",
        "[ -n ${WSL_AUTH_SOCK} ] && export SSH_AUTH_SOCK=${WSL_AUTH_SOCK}"
    ]
}
